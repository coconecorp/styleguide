# Javaスタイルガイド

<details><summary>目次</summary>

- [はじめに](#はじめに)
- [ソースファイルの基本事項](#ソースファイルの基本事項)
  - [ファイル名](#ファイル名)
  - [ファイルのエンコーディング](#ファイルのエンコーディング)
  - [特殊文字](#特殊文字)
    - [特殊なエスケープシーケンス](#特殊なエスケープシーケンス)
    - [非ASCII文字](#非ascii文字)
- [ソースファイルの構造](#ソースファイルの構造)
  - [package文](#package文)
  - [import文](#import文)
    - [ワイルドカードインポート](#ワイルドカードインポート)
    - [改行](#改行)
    - [順序と空白](#順序と空白)
    - [クラスのstaticインポート](#クラスのstaticインポート)
  - [クラス宣言](#クラス宣言)
    - [1個だけのトップレベルクラスの宣言](#1個だけのトップレベルクラスの宣言)
    - [クラスメンバーの順序](#クラスメンバーの順序)
    - [オーバーロードしているメソッド群の分離](#オーバーロードしているメソッド群の分離)
- [フォーマット](#フォーマット)
  - [波括弧`{}`](#波括弧)
    - [空でないブロック](#空でないブロック)
    - [空のブロック](#空のブロック)
  - [ブロックのインデント](#ブロックのインデント)
  - [文の末尾](#文の末尾)
  - [1行の文字数](#1行の文字数)
  - [行の折り返し](#行の折り返し)
  - [空白](#空白)
    - [水平の位置揃え](#水平の位置揃え)
  - [各構造物](#各構造物)
    - [列挙型](#列挙型)
    - [変数宣言](#変数宣言)
    - [配列](#配列)
    - [switch文](#switch文)
    - [アノテーション](#アノテーション)
    - [コメント](#コメント)
    - [修飾子](#修飾子)
    - [数値リテラル](#数値リテラル)
- [命名](#命名)
  - [識別子の共通ルール](#識別子の共通ルール)
  - [識別子の種類ごとのルール](#識別子の種類ごとのルール)
    - [パッケージ名](#パッケージ名)
    - [クラス名](#クラス名)
    - [関数名](#関数名)
    - [定数名](#定数名)
    - [定数でないフィールド名](#定数でないフィールド名)
    - [パラメータ名](#パラメータ名)
    - [ローカル変数名](#ローカル変数名)
    - [型変数名](#型変数名)
- [プログラミングの実践](#プログラミングの実践)
  - [@Override](#override)
  - [`catch`節](#catch節)
  - [staticなメンバー](#staticなメンバー)
  - [`finalize()`メソッド](#finalizeメソッド)
- [Javadoc](#javadoc)
  - [フォーマット](#フォーマット-1)
  - [要約](#要約)
  - [記述場所](#記述場所)

</details>

## はじめに

- 本ガイドラインは、[ココネ株式会社](https://www.cocone.co.jp/)におけるJavaのコーディング規則を示すものです。
- 本ガイドラインは、『[Google Java Style Guide](https://google.github.io/styleguide/javaguide.html)』を参考に規定しています。
- 本ガイドラインで未定義のスタイルや、詳細を定義していない箇所の議論となった場合は、『[Google Java Style Guide](https://google.github.io/styleguide/javaguide.html)』を参考に検討することとします。

<div align="right">
<a href="#">⬆️ 先頭に戻る</a>
</div>

## ソースファイルの基本事項

### ファイル名

- 【必須】ソースファイル名は、そのファイルに（正確に1つ）入っているトップレベルクラスの大文字、小文字を区別した名前に加え、拡張子`.java`を付けなければなりません。

<div align="right">
<a href="#">⬆️ 先頭に戻る</a>
</div>

### ファイルのエンコーディング

- 【必須】ソースファイルは、UTF-8でエンコードされていなければなりません。

<div align="right">
<a href="#">⬆️ 先頭に戻る</a>
</div>

### 特殊文字

- 【必須】改行以外の空白文字は、`ASCII水平スペース文字（0×20）`しか使用してはいけません。

つまり、次の意味になります。

- Stringと文字リテラルで、ASCII水平スペース文字以外の空白文字はエスケープされていなければなりません。
- タブ文字をインデントの目的で使用してはいけません。

<div align="right">
<a href="#">⬆️ 先頭に戻る</a>
</div>

#### 特殊なエスケープシーケンス

- 【推奨】特別なエスケープシーケンスをもつすべての文字（`\b` `\t` `\n` `\f` `\r` `\"` `\'` `\\`）は、8進数表記（`\012`）やUnicodeエスケープ（`\u000a`）でなく、通常のエスケープシーケンスの使用を推奨します。

<div align="right">
<a href="#">⬆️ 先頭に戻る</a>
</div>

#### 非ASCII文字

- 【必須】文字列リテラルやコメント以外で、Unicodeエスケープは使用してはいけません（例：`\u221e`ではなく、`∞`を使用すべきです）。
- 【必須】プログラムが非ASCII文字を正しく処理しないという理由だけで、余計なコードを増やしてはいけません。

<div align="right">
<a href="#">⬆️ 先頭に戻る</a>
</div>

## ソースファイルの構造

- 【必須】ソースファイルの内容は、次の順序でなければなりません。
  
1. ライセンスあるいはコピーライトの情報（存在する場合）
2. package文
3. import文
4. ただ1個のトップレベルクラス

- 【必須】ソースファイルの内容を分離する場合、複数ではなく1行の空行を使用しなければなりません。

<div align="right">
<a href="#">⬆️ 先頭に戻る</a>
</div>

### package文

- 【必須】package文は改行してはいけません。

<div align="right">
<a href="#">⬆️ 先頭に戻る</a>
</div>

### import文

#### ワイルドカードインポート

- 【必須】ワイルドカードインポートは、`static`に関係なく使用してはいけません。

<div align="right">
<a href="#">⬆️ 先頭に戻る</a>
</div>

#### 改行

- 【必須】import文は改行してはいけません。

<div align="right">
<a href="#">⬆️ 先頭に戻る</a>
</div>

#### 順序と空白

- 【必須】import文は次の順序で並べなけばなりません。

1. すべてのstaticインポートを単一のブロックでまとめる。
2. すべての非staticインポートを単一のブロックでまとめる。

- 【必須】staticインポートと非staticインポートの両方が存在する場合、1つの空行でそれぞれ分離しなければなりません。
- 【必須】import節の間は、空行で分離してはいけません。
- 【必須】各ブロック内で、インポートされた名前はASCII順で並べなければなりません。

<div align="right">
<a href="#">⬆️ 先頭に戻る</a>
</div>

#### クラスのstaticインポート

- 【必須】staticなネストしたクラスをインポートする場合、`static import`を使用せず、通常のインポートを使用しなければなりません。

<div align="right">
<a href="#">⬆️ 先頭に戻る</a>
</div>

### クラス宣言

#### 1個だけのトップレベルクラスの宣言

- 【必須】各トップレベルのクラスは、それぞれのソースファイルに1つずつ存在しなければなりません。

<div align="right">
<a href="#">⬆️ 先頭に戻る</a>
</div>

#### クラスメンバーの順序

- 【必須】それぞれのクラスはそのメンバーを説明がつく合理的な順序で並べ、クラスの運用担当者は、順番の理由を答えられるようにしなければなりません。

<div align="right">
<a href="#">⬆️ 先頭に戻る</a>
</div>

#### オーバーロードしているメソッド群の分離

- 【必須】クラスに複数のコンストラクタや同じ名前をもつメソッドがある場合は、別のコードを（`private`なメンバであっても）入れず、連続して並べなければなりません。
  
<div align="right">
<a href="#">⬆️ 先頭に戻る</a>
</div>

## フォーマット

### 波括弧`{}`

#### 空でないブロック

- 【必須】波括弧`{}`は空でないブロックや、ブロックの構造物ではK&Rスタイル『[エジプト人ブレース](http://www.codinghorror.com/blog/2012/07/new-programming-jargon.html)』に従わなければなりません。

つまり、

- 開始波括弧`{`の前に改行を入れてはいけません。
- 開始波括弧`{`の後に改行を入れなければなりません。
- 終了波括弧`}`の前に改行を入れなければなりません。
- 終了波括弧`}`の後に改行を入れなければなりません。これは文やメソッドの本体を終える場合になります。たとえば、終了波括弧`}`の後に`else`や、カンマ`,`が続く場合は改行しません。

```java
return () -> {
    while (condition()) {
        method();
    }
};

return new MyClass() {
    @Override public void method() {
        if (condition()) {
            try {
                something();
            } catch (ProblemException e) {
                recover();
            }
        } else if (otherCondition()) {
            somethingElse();
        } else {
            lastThing();
        }
    }
};
```

<div align="right">
<a href="#">⬆️ 先頭に戻る</a>
</div>

#### 空のブロック

- 【必須】空のブロックは、空ではないブロック同様、K&Rスタイル『[エジプト人ブレース](http://www.codinghorror.com/blog/2012/07/new-programming-jargon.html)』に従わなければなりません。
- 【必須】`if/else`や`try/catch/finally`のような複数ブロックは、開始波括弧`{`直後に、文字や改行無しで終了波括弧`}`を使用してはなりません。それ以外は空のブロック`{}`を使用してよいものとします。

`catch`節の規定は、[`catch`節](#catch節)の章をご覧ください。

```java
// 正しい：
void doNothing() {}

// 正しい：
void doNothing() {
}

// 間違い：複数ブロックの文では、空ブロックを使用してはなりません
try {
  doSomething();
} catch (Exception e) {}
```

<div align="right">
<a href="#">⬆️ 先頭に戻る</a>
</div>

### ブロックのインデント

- 【必須】Javaのインデントは、半角スペース**4**つとしなければなりません。

```java
// 正しい：半角スペース4個のインデント
class MyClass implements MyInterface {
    void foo() {...}
    ...
}

// 間違い：半角スペース2個のインデント
class MyClass implements MyInterface {
  void foo() {...}
  ...
}
```

<div align="right">
<a href="#">⬆️ 先頭に戻る</a>
</div>

### 文の末尾

- 【必須】各文の末尾は改行でなくてはなりません。

<div align="right">
<a href="#">⬆️ 先頭に戻る</a>
</div>

### 1行の文字数

- 【必須】コードの1行の文字数制限は**200文字**とし、制限を超えた行は改行しなければなりません。

例外：

- Javadoc内の長いURLなど、文字数制限に従うのが不可能の場合
- package文やimport文
- コメント内に記載しているコマンド

<div align="right">
<a href="#">⬆️ 先頭に戻る</a>
</div>

### 行の折り返し

- 【必須】代入でない演算子で改行する場合、シンボルの前で改行しなければなりません。この規定は、次のシンボルにも適用されます。
  - ドット演算子`.` 
  - メソッド参照で使用する2つのコロン`::`
  - 型演算子の`&`記号`<T extends Foo & Bar>`
  - catch節でのパイプ記号`catch (FooException | BarException e)`
- 【必須】メソッド名やコンストラクタ名と、直後の開始丸括弧`(`の間は、改行してはいけません。
- 【必須】カンマ`,`は、その前のトークンの直後に続いて書かなくてはなりません。改行してはいけません。
- 【必須】ラムダ式の矢印`->`の直後で改行してはいけません。<br>
    例外：ラムダ式の本体が単一の括弧なしの式の場合は、改行してもよいものとします。
    ```java
    Predicate<String> predicate = str ->
        longExpressionInvolving(str);
    ```
- 【必須】改行の場合、連続する先頭行に続く各行は、少なくとも半角スペース4つでインデントしなければなりません。

<div align="right">
<a href="#">⬆️ 先頭に戻る</a>
</div>

### 空白

- 【必須】予約語`if` `for` `catch`と、その行の開始丸括弧`(`の間は、半角スペース1つで離さなければなりません。
- 【必須】予約語 `else` `catch`と、その行の前の終了波括弧`}`の間は、半角スペース1つで離さなければなりません。
- 【必須】開始波括弧`{`の前は、半角スペース1つで離さなければなりません。<br>
    例外：
    - `@SomeAnnotation({a, b})`
    - `String[][] x = {{"foo"}};`
- 【必須】二項演算子や三項演算子の両側は、半角スペース1つで離さなければなりません。
- 【必須】演算子に似たシンボルでも。半角スペース1つで離さなければなりません。
    - 連続する型パラメータ間のアンパサンド `<T extends Foo & Bar>`
    - 複数の例外を処理するcatchブロックでのパイプ `catch (FooException | BarException e)`
    - 拡張`for`文（"foreach"）でのコロン`:`
    - ラムダ式での矢印`(String str) -> str.length()`
    例外：
    - `Object::toString`と書かれるような、メソッド参照でのコロン2つ`::`
    - `object.toString`と書かれるような、ドット演算子`.`
- 【必須】カンマ`,`、コロン`:`、セミコロン`;`、あるいはキャストの終了丸括弧`)`の直後は、半角スペース1つで離さなければなりません。
- 【必須】行末コメントの開始スラッシュ`//`の前後は、半角スペース1つで離さなければなりません。
- 【必須】型と変数の宣言の間`List<String> list`は、半角スペース1つで離さなければなりません。
- 【必須】型アノテーションと `[]` または `...` の間は、半角スペース1つで離さなければなりません。

<div align="right">
<a href="#">⬆️ 先頭に戻る</a>
</div>

#### 水平の位置揃え

- 【推奨】水平の位置揃えは推奨しません。

```java
// 推奨：位置揃えをしない
private int x; // this is fine
private Color color; // this too

// 非推奨：位置揃えをしている（維持は推奨しません）
private int   x;      // permitted, but future edits
private Color color;  // may leave it unaligned
```

- 【推奨】既存のコードで、位置を揃えてしまっている場合、位置揃えの維持は推奨しません。

<div align="right">
<a href="#">⬆️ 先頭に戻る</a>
</div>

### 各構造物

#### 列挙型

- 【必須】列挙定数値の後ろのカンマ`,`の後は改行しなければなりません。

```java
private enum Answer {
  YES {
    @Override public String toString() {
      return "yes";
    }
  },

  NO, // 改行
  MAYBE
}
```

<div align="right">
<a href="#">⬆️ 先頭に戻る</a>
</div>

#### 変数宣言

- 【必須】フィールドやローカル変数の変数宣言は、1つずつ宣言しなければなりません。

```java
// 正しい：
int a;
int b;

// 間違い：
int a, b;
```

- 【必須】ローカル変数は、それを含むブロックや構造物の先頭で慣習的に宣言してはなりません。
- 【必須】ローカル変数は、そのスコープを最小化する目的で、最初に使用する場所の近くで宣言しなければなりません。

<div align="right">
<a href="#">⬆️ 先頭に戻る</a>
</div>

#### 配列

- 【必須】配列を宣言する場合、`String[] args`とすべきです。C言語のように`String args[]`としてはいけません。

<div align="right">
<a href="#">⬆️ 先頭に戻る</a>
</div>

#### switch文

- 【必須】他のブロックと同様、switch文のブロックは半角スペース4つでインデントしなければなりません。
  
```java
switch (input) {
    case 1:
    case 2:
        prepareOneOrTwo();
        // fall through
    case 3:
        handleOneTwoOrThree();
        break;
    default:
        handleLargeNumber(input);
}
```

- 【必須】switch文はたとえコードがない場合でも、`default`ステートメントグループを使用しなければなりません。

例外：`enum`型でのswitch文で、その型のすべてのあり得る値を明示的に含めている場合にかぎり、`default`ステートメントグループを省略できます。

<div align="right">
<a href="#">⬆️ 先頭に戻る</a>
</div>

#### アノテーション

- 【必須】クラス、メソッド、コンストラクタのアノテーションに、インデントを使用してはいけません。

```java
// 正しい：
@Override
@Nullable
public String getNameIfPresent() { ... }

// 間違い：
    @Override
    @Nullable
    public String getNameIfPresent() { ... }
```

単一のパラメータ無しのアノテーションの場合、シグネチャー行の先頭で指定してもよいこととします。

```java
@Override public int hashCode() { ... }
```

フィールドへのアノテーションについて、複数のアノテーション（パラメータが付きの可能性もある）を同じ行で指定してもよいこととします。

```java
@Partial @Mock DataLoader loader;
```

<div align="right">
<a href="#">⬆️ 先頭に戻る</a>
</div>

#### コメント

- 【必須】ブロックコメント`/* ... */`や行コメント`//`は、周りのコードと同じレベルにインデントしなければなりません。
- 【必須】ブロックコメント`/* ... */`のアスアリスク`*`の位置は、前の行のアスタリスク`*`と同じ位置に揃えなければなりません。
- 【必須】コメントはアスタリスク`*`や他の文字で囲んではいけません。

<div align="right">
<a href="#">⬆️ 先頭に戻る</a>
</div>

#### 修飾子

- 【必須】クラスやメンバの修飾子を宣言する場合、Javaの仕様が推奨する順序で宣言しなければなりません。

```java
public protected private abstract default static final transient volatile synchronized native strictfp
```

<div align="right">
<a href="#">⬆️ 先頭に戻る</a>
</div>

#### 数値リテラル

- 【必須】`long`型の数値リテラルは、数字`1`との混乱を避ける目的で、大文字の`L`を末尾に使用しなければなりません（例：`3000000000l`ではなく`3000000000L`）。

<div align="right">
<a href="#">⬆️ 先頭に戻る</a>
</div>

## 命名

### 識別子の共通ルール

- 【必須】原則として、識別子の名前は正規表現`\w+`にマッチした文字（ASCII文字、数字）を使用しなければなりません。
- 【必須】`name_` `mName` `s_name` `kName` といったような特別な接尾辞・接頭辞を使用してはいけません。

<div align="right">
<a href="#">⬆️ 先頭に戻る</a>
</div>

### 識別子の種類ごとのルール

#### パッケージ名

- 【必須】パッケージ名は、すべて小文字で連続する単語をそのまま繋げなければなりません。アンダースコアは使用してはいけません（例：`com.example.deepspace`であって、`com.example.deepSpace` `com.example.deep_space`ではありません）。

<div align="right">
<a href="#">⬆️ 先頭に戻る</a>
</div>

#### クラス名

- 【必須】クラス名は、大文字のCamel形式（"UpperCamelCase"）で命名しなければなりません。
- 【必須】テストのクラス名は、テスト対象クラスの名前で始め、`Test`で終わるように命名しなければなりません（例：`HashTest` `HashIntegrationTest`）。

<div align="right">
<a href="#">⬆️ 先頭に戻る</a>
</div>

#### 関数名

- 【必須】関数名は、小文字のCamel形式（"lowerCamelCase"）で命名しなければなりません。

例外：アンダースコア`_`は、JUnitの関数名で名前の論理的コンポーネント名（"lowerCamelCase"）を分離する目的で使用できます。

<div align="right">
<a href="#">⬆️ 先頭に戻る</a>
</div>

#### 定数名

- 【必須】定数名は、コンスタントケース（`CONSTANT_CASE`）で命名しなければなりません。すべて大文字で、各単語を1つのアンダースコアで繋げなければなりません。

<div align="right">
<a href="#">⬆️ 先頭に戻る</a>
</div>

#### 定数でないフィールド名

- 【必須】定数でないフィールド名は、`static`に関係なく小文字のCamel形式（"lowerCamelCase"）で命名しなければなりません。

<div align="right">
<a href="#">⬆️ 先頭に戻る</a>
</div>

#### パラメータ名

- 【必須】パラメータ名は、小文字のCamel形式（"lowerCamelCase"）で命名しなければなりません。
- 【必須】`public`なメソッドで、一文字のパラメータ名を使用してはいけません。

<div align="right">
<a href="#">⬆️ 先頭に戻る</a>
</div>

#### ローカル変数名

- 【必須】ローカル変数名は、小文字のCamel形式（"lowerCamelCase"）で命名しなければなりません。
- 【必須】`final`の場合でも、ローカル変数は定数とは見なされないので、定数として命名してはいけません。

<div align="right">
<a href="#">⬆️ 先頭に戻る</a>
</div>

#### 型変数名

- 【必須】型変数名は次のうちいずれかで命名しなければなりません。
  - 1つの大文字アルファベットの後に、1つの数字を続ける（例： `E` `T` `X` `T2`）。
  - クラスの命名規定の後に、大文字`T`を続ける（例： `RequestT` `FooBarT`）。

<div align="right">
<a href="#">⬆️ 先頭に戻る</a>
</div>

## プログラミングの実践

### @Override

- 【必須】親メソッドが`@Deprecated`の場合を除き、適用可能ならば、メソッドに`@Override`アノテーションを付与しなければなりません。


<div align="right">
<a href="#">⬆️ 先頭に戻る</a>
</div>

### `catch`節

- 【必須】`catch`節で、何もしないことが適切な場合は、その理由をコメントで説明しなければなりません。

```java
try {
    int i = Integer.parseInt(response);
    return handleNumericResponse(i);
} catch (NumberFormatException ok) {
    // 数値ではありませんが、問題ありません
}
return handleTextResponse(response);
```

`catch`節のブロックに関する規定は、[空のブロック](#空のブロック)の章をご覧ください。

<div align="right">
<a href="#">⬆️ 先頭に戻る</a>
</div>

### staticなメンバー

- 【必須】 staticなメンバーを修飾する必要がある場合は、クラス名を使用しなければなりません。
- 【必須】 staticなメンバーを修飾する必要がある場合は、クラスの変数や式経由で使用してはいけません。
  
```java
Foo aFoo = ...;
Foo.aStaticMethod(); // 正しい
aFoo.aStaticMethod(); // 間違い
somethingThatYieldsAFoo().aStaticMethod(); // 間違い
```

<div align="right">
<a href="#">⬆️ 先頭に戻る</a>
</div>

### `finalize()`メソッド

- 【必須】Objectクラスの`finalize()`メソッドは使用してはいけません。


<div align="right">
<a href="#">⬆️ 先頭に戻る</a>
</div>

## Javadoc

### フォーマット

- 【必須】ブロックタグは、`@param` `@return` `@throws` `@deprecated`の順番で使用しなければなりません。
- 【必須】ブロックタグの`@param` `@return` `@throws` `@deprecated`は、必ず存在しなければなりません。
- 【必須】ブロックタグが1行のコメントに収まらない場合、2行目以降は`@`の位置から半角スペース4つ以上でインデントしなければなりません。

<div align="right">
<a href="#">⬆️ 先頭に戻る</a>
</div>

### 要約

- 【必須】すべてのブロックは、簡潔な要約から始めなければなりません。
  - 「このクラス{@code Foo} は…」とか、「このメソッドは…を返す」で始めてはいけません。
  - 「結果を保存しなさい」というような、命令形でもいけません。
  - `/** 顧客IDを返す。 */`と記述します。`/** @return 顧客ID */`といった記述は間違いです。

<div align="right">
<a href="#">⬆️ 先頭に戻る</a>
</div>

### 記述場所

- 【必須】原則として、Javadocは、`public`なクラスとそのクラスの`public protected`なメンバーに対し書かなければなりません。

例外：

- `getFoo`のような「fooを返す」以外の情報が無く、簡単で明確なメソッドの場合、記述は不要です。
- 親クラスのメソッドをオーバーライドするメソッドについては、記述は不要です。

<div align="right">
<a href="#">⬆️ 先頭に戻る</a>
</div>